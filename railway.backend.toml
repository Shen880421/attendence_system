version: 2

environments:
  production:
    variables:
      NODE_ENV: production
      PORT: ${{PORT}}
      
build:
  commands:
    - echo "Building backend with Maven..."
  
deploy:
  startCommand: "java -jar target/backend-0.0.1-SNAPSHOT.jar"
  healthcheckPath: "/actuator/health"
  
services:
  backend:
    source: ./backend
    build:
      commands:
        - "./mvnw clean package -DskipTests"
    deploy:
      startCommand: "java -Dserver.port=$PORT -jar target/backend-0.0.1-SNAPSHOT.jar"
